id: auth-failures
name: Identification and Authentication Failures
description: Detects weak authentication mechanisms and session management issues
severity: HIGH
type: AUTHENTICATION
languages:
  - python
patterns:
  - pattern: |
      def login():
          if $USERNAME == $INPUT_USERNAME and $PASSWORD == $INPUT_PASSWORD:
              $BODY
    message: Weak password comparison
    fix: Use secure password hashing and comparison
  - pattern: |
      session['user_id'] = $USER_ID
      session.permanent = True
    message: Insecure session configuration
    fix: Set appropriate session timeouts and secure flags
  - pattern: |
      @app.route('/reset-password')
      def reset_password():
          $BODY
    message: Missing rate limiting on password reset
    fix: Implement rate limiting and secure token generation
  - pattern: |
      def change_password($USER, $OLD_PASSWORD, $NEW_PASSWORD):
          if $OLD_PASSWORD == $USER.password:
              $USER.password = $NEW_PASSWORD
    message: Weak password change mechanism
    fix: Implement proper password validation and secure storage 