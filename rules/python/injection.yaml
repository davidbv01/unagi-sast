id: injection
name: Injection Vulnerabilities
description: Detects various injection vulnerabilities including SQL, NoSQL, LDAP, and OS command injection
severity: CRITICAL
type: SQL_INJECTION
languages:
  - python
patterns:
  - pattern: |
      cursor.execute("SELECT * FROM $TABLE WHERE $FIELD = '" + $INPUT + "'")
    message: SQL injection vulnerability detected
    fix: Use parameterized queries or ORM
  - pattern: |
      subprocess.call($CMD + " " + $INPUT)
    message: Command injection vulnerability detected
    fix: Use subprocess with shell=False and proper argument lists
  - pattern: |
      eval($INPUT)
    message: Code injection vulnerability detected
    fix: Avoid using eval() with user input
  - pattern: |
      yaml.load($INPUT)
    message: YAML deserialization vulnerability detected
    fix: Use yaml.safe_load() instead
  - pattern: |
      pickle.loads($INPUT)
    message: Pickle deserialization vulnerability detected
    fix: Use safe deserialization methods or validate input 