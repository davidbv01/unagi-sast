id: integrity-failures
name: Software and Data Integrity Failures
description: Detects insecure deserialization and integrity verification issues
severity: HIGH
type: INSECURE_DESERIALIZATION
languages:
  - python
patterns:
  - pattern: |
      import pickle
      $DATA = pickle.loads($INPUT)
    message: Insecure deserialization with pickle
    fix: Use safe deserialization methods or validate input
  - pattern: |
      import yaml
      $DATA = yaml.load($INPUT)
    message: Insecure YAML deserialization
    fix: Use yaml.safe_load() instead
  - pattern: |
      import json
      $DATA = json.loads($INPUT)
    message: Missing input validation for JSON deserialization
    fix: Validate input before deserialization
  - pattern: |
      import requests
      $RESPONSE = requests.get($URL)
      exec($RESPONSE.text)
    message: Insecure code execution from external source
    fix: Validate and sanitize external data before use 