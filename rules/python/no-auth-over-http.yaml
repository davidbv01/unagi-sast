rules:
  - id: no-auth-over-http
    patterns:
      - pattern: requests.$FUNC("http://$URL", auth=$AUTH)
    message: "No uses auth sobre HTTP sin cifrado"
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      description: "Detects authentication being sent over unencrypted HTTP connections"
      references:
        - "https://owasp.org/www-community/attacks/ManInTheMiddle"
      cwe: "CWE-319: Cleartext Transmission of Sensitive Information" 