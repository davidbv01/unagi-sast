id: logging-failures
name: Logging and Monitoring Failures
description: Detects insufficient logging and monitoring
severity: MEDIUM
type: GENERIC
languages:
  - python
patterns:
  - pattern: |
      try:
          $BODY
      except Exception as e:
          print(e)
    message: Insufficient error logging
    fix: Use proper logging with appropriate log levels
  - pattern: |
      def $FUNC(...):
          $BODY
          return $RESPONSE
    message: Missing audit logging
    fix: Add audit logging for sensitive operations
  - pattern: |
      import logging
      logging.basicConfig(level=logging.INFO)
    message: Insufficient log configuration
    fix: Configure proper log rotation and security
  - pattern: |
      def login($USERNAME, $PASSWORD):
          $BODY
    message: Missing security event logging
    fix: Log security events like login attempts 